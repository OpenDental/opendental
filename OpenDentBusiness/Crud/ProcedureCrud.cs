//This file is automatically generated.
//Do not attempt to make changes to this file because the changes will be erased and overwritten.
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;

namespace OpenDentBusiness.Crud{
	public class ProcedureCrud {
		///<summary>Gets one Procedure object from the database using the primary key.  Returns null if not found.</summary>
		public static Procedure SelectOne(long procNum) {
			string command="SELECT * FROM procedurelog "
				+"WHERE ProcNum = "+POut.Long(procNum);
			List<Procedure> list=TableToList(Db.GetTable(command));
			if(list.Count==0) {
				return null;
			}
			return list[0];
		}

		///<summary>Gets one Procedure object from the database using a query.</summary>
		public static Procedure SelectOne(string command) {
			if(RemotingClient.RemotingRole==RemotingRole.ClientWeb) {
				throw new ApplicationException("Not allowed to send sql directly.  Rewrite the calling class to not use this query:\r\n"+command);
			}
			List<Procedure> list=TableToList(Db.GetTable(command));
			if(list.Count==0) {
				return null;
			}
			return list[0];
		}

		///<summary>Gets a list of Procedure objects from the database using a query.</summary>
		public static List<Procedure> SelectMany(string command) {
			if(RemotingClient.RemotingRole==RemotingRole.ClientWeb) {
				throw new ApplicationException("Not allowed to send sql directly.  Rewrite the calling class to not use this query:\r\n"+command);
			}
			List<Procedure> list=TableToList(Db.GetTable(command));
			return list;
		}

		///<summary>Converts a DataTable to a list of objects.</summary>
		public static List<Procedure> TableToList(DataTable table) {
			List<Procedure> retVal=new List<Procedure>();
			Procedure procedure;
			foreach(DataRow row in table.Rows) {
				procedure=new Procedure();
				procedure.ProcNum            = PIn.Long  (row["ProcNum"].ToString());
				procedure.PatNum             = PIn.Long  (row["PatNum"].ToString());
				procedure.AptNum             = PIn.Long  (row["AptNum"].ToString());
				procedure.OldCode            = PIn.String(row["OldCode"].ToString());
				procedure.ProcDate           = PIn.Date  (row["ProcDate"].ToString());
				procedure.ProcFee            = PIn.Double(row["ProcFee"].ToString());
				procedure.Surf               = PIn.String(row["Surf"].ToString());
				procedure.ToothNum           = PIn.String(row["ToothNum"].ToString());
				procedure.ToothRange         = PIn.String(row["ToothRange"].ToString());
				procedure.Priority           = PIn.Long  (row["Priority"].ToString());
				procedure.ProcStatus         = (OpenDentBusiness.ProcStat)PIn.Int(row["ProcStatus"].ToString());
				procedure.ProvNum            = PIn.Long  (row["ProvNum"].ToString());
				procedure.Dx                 = PIn.Long  (row["Dx"].ToString());
				procedure.PlannedAptNum      = PIn.Long  (row["PlannedAptNum"].ToString());
				procedure.PlaceService       = (OpenDentBusiness.PlaceOfService)PIn.Int(row["PlaceService"].ToString());
				procedure.Prosthesis         = PIn.String(row["Prosthesis"].ToString());
				procedure.DateOriginalProsth = PIn.Date  (row["DateOriginalProsth"].ToString());
				procedure.ClaimNote          = PIn.String(row["ClaimNote"].ToString());
				procedure.DateEntryC         = PIn.Date  (row["DateEntryC"].ToString());
				procedure.ClinicNum          = PIn.Long  (row["ClinicNum"].ToString());
				procedure.MedicalCode        = PIn.String(row["MedicalCode"].ToString());
				procedure.DiagnosticCode     = PIn.String(row["DiagnosticCode"].ToString());
				procedure.IsPrincDiag        = PIn.Bool  (row["IsPrincDiag"].ToString());
				procedure.ProcNumLab         = PIn.Long  (row["ProcNumLab"].ToString());
				procedure.BillingTypeOne     = PIn.Long  (row["BillingTypeOne"].ToString());
				procedure.BillingTypeTwo     = PIn.Long  (row["BillingTypeTwo"].ToString());
				procedure.CodeNum            = PIn.Long  (row["CodeNum"].ToString());
				procedure.CodeMod1           = PIn.String(row["CodeMod1"].ToString());
				procedure.CodeMod2           = PIn.String(row["CodeMod2"].ToString());
				procedure.CodeMod3           = PIn.String(row["CodeMod3"].ToString());
				procedure.CodeMod4           = PIn.String(row["CodeMod4"].ToString());
				procedure.RevCode            = PIn.String(row["RevCode"].ToString());
				procedure.UnitQty            = PIn.Int   (row["UnitQty"].ToString());
				procedure.BaseUnits          = PIn.Int   (row["BaseUnits"].ToString());
				procedure.StartTime          = PIn.Int   (row["StartTime"].ToString());
				procedure.StopTime           = PIn.Int   (row["StopTime"].ToString());
				procedure.DateTP             = PIn.Date  (row["DateTP"].ToString());
				procedure.SiteNum            = PIn.Long  (row["SiteNum"].ToString());
				procedure.HideGraphics       = PIn.Bool  (row["HideGraphics"].ToString());
				procedure.CanadianTypeCodes  = PIn.String(row["CanadianTypeCodes"].ToString());
				procedure.ProcTime           = PIn.Time(row["ProcTime"].ToString());
				procedure.ProcTimeEnd        = PIn.Time(row["ProcTimeEnd"].ToString());
				procedure.DateTStamp         = PIn.DateT (row["DateTStamp"].ToString());
				procedure.Prognosis          = PIn.Long  (row["Prognosis"].ToString());
				procedure.DrugUnit           = (OpenDentBusiness.EnumProcDrugUnit)PIn.Int(row["DrugUnit"].ToString());
				procedure.DrugQty            = PIn.Float (row["DrugQty"].ToString());
				procedure.UnitQtyType        = (OpenDentBusiness.ProcUnitQtyType)PIn.Int(row["UnitQtyType"].ToString());
				procedure.StatementNum       = PIn.Long  (row["StatementNum"].ToString());
				procedure.IsLocked           = PIn.Bool  (row["IsLocked"].ToString());
				procedure.BillingNote        = PIn.String(row["BillingNote"].ToString());
				procedure.RepeatChargeNum    = PIn.Long  (row["RepeatChargeNum"].ToString());
				procedure.DiagnosticCode2    = PIn.String(row["DiagnosticCode2"].ToString());
				procedure.DiagnosticCode3    = PIn.String(row["DiagnosticCode3"].ToString());
				procedure.DiagnosticCode4    = PIn.String(row["DiagnosticCode4"].ToString());
				procedure.Discount           = PIn.Double(row["Discount"].ToString());
				procedure.SnomedBodySite     = PIn.String(row["SnomedBodySite"].ToString());
				procedure.ProvOrderOverride  = PIn.Long  (row["ProvOrderOverride"].ToString());
				procedure.IsDateProsthEst    = PIn.Bool  (row["IsDateProsthEst"].ToString());
				procedure.IcdVersion         = PIn.Byte  (row["IcdVersion"].ToString());
				procedure.IsCpoe             = PIn.Bool  (row["IsCpoe"].ToString());
				procedure.SecUserNumEntry    = PIn.Long  (row["SecUserNumEntry"].ToString());
				procedure.SecDateEntry       = PIn.Date  (row["SecDateEntry"].ToString());
				procedure.DateComplete       = PIn.Date  (row["DateComplete"].ToString());
				procedure.OrderingReferralNum= PIn.Long  (row["OrderingReferralNum"].ToString());
				procedure.TaxAmt             = PIn.Double(row["TaxAmt"].ToString());
				procedure.Urgency            = (OpenDentBusiness.ProcUrgency)PIn.Int(row["Urgency"].ToString());
				procedure.DiscountPlanAmt    = PIn.Double(row["DiscountPlanAmt"].ToString());
				retVal.Add(procedure);
			}
			return retVal;
		}

		///<summary>Converts an IDataRecord to a Procedure object.</summary>
		public static Procedure RowToObj(IDataRecord row) {
			return new Procedure {
				ProcNum            = PIn.Long  (row["ProcNum"].ToString()),
				PatNum             = PIn.Long  (row["PatNum"].ToString()),
				AptNum             = PIn.Long  (row["AptNum"].ToString()),
				OldCode            = PIn.String(row["OldCode"].ToString()),
				ProcDate           = PIn.Date  (row["ProcDate"].ToString()),
				ProcFee            = PIn.Double(row["ProcFee"].ToString()),
				Surf               = PIn.String(row["Surf"].ToString()),
				ToothNum           = PIn.String(row["ToothNum"].ToString()),
				ToothRange         = PIn.String(row["ToothRange"].ToString()),
				Priority           = PIn.Long  (row["Priority"].ToString()),
				ProcStatus         = (OpenDentBusiness.ProcStat)PIn.Int(row["ProcStatus"].ToString()),
				ProvNum            = PIn.Long  (row["ProvNum"].ToString()),
				Dx                 = PIn.Long  (row["Dx"].ToString()),
				PlannedAptNum      = PIn.Long  (row["PlannedAptNum"].ToString()),
				PlaceService       = (OpenDentBusiness.PlaceOfService)PIn.Int(row["PlaceService"].ToString()),
				Prosthesis         = PIn.String(row["Prosthesis"].ToString()),
				DateOriginalProsth = PIn.Date  (row["DateOriginalProsth"].ToString()),
				ClaimNote          = PIn.String(row["ClaimNote"].ToString()),
				DateEntryC         = PIn.Date  (row["DateEntryC"].ToString()),
				ClinicNum          = PIn.Long  (row["ClinicNum"].ToString()),
				MedicalCode        = PIn.String(row["MedicalCode"].ToString()),
				DiagnosticCode     = PIn.String(row["DiagnosticCode"].ToString()),
				IsPrincDiag        = PIn.Bool  (row["IsPrincDiag"].ToString()),
				ProcNumLab         = PIn.Long  (row["ProcNumLab"].ToString()),
				BillingTypeOne     = PIn.Long  (row["BillingTypeOne"].ToString()),
				BillingTypeTwo     = PIn.Long  (row["BillingTypeTwo"].ToString()),
				CodeNum            = PIn.Long  (row["CodeNum"].ToString()),
				CodeMod1           = PIn.String(row["CodeMod1"].ToString()),
				CodeMod2           = PIn.String(row["CodeMod2"].ToString()),
				CodeMod3           = PIn.String(row["CodeMod3"].ToString()),
				CodeMod4           = PIn.String(row["CodeMod4"].ToString()),
				RevCode            = PIn.String(row["RevCode"].ToString()),
				UnitQty            = PIn.Int   (row["UnitQty"].ToString()),
				BaseUnits          = PIn.Int   (row["BaseUnits"].ToString()),
				StartTime          = PIn.Int   (row["StartTime"].ToString()),
				StopTime           = PIn.Int   (row["StopTime"].ToString()),
				DateTP             = PIn.Date  (row["DateTP"].ToString()),
				SiteNum            = PIn.Long  (row["SiteNum"].ToString()),
				HideGraphics       = PIn.Bool  (row["HideGraphics"].ToString()),
				CanadianTypeCodes  = PIn.String(row["CanadianTypeCodes"].ToString()),
				ProcTime           = PIn.Time(row["ProcTime"].ToString()),
				ProcTimeEnd        = PIn.Time(row["ProcTimeEnd"].ToString()),
				DateTStamp         = PIn.DateT (row["DateTStamp"].ToString()),
				Prognosis          = PIn.Long  (row["Prognosis"].ToString()),
				DrugUnit           = (OpenDentBusiness.EnumProcDrugUnit)PIn.Int(row["DrugUnit"].ToString()),
				DrugQty            = PIn.Float (row["DrugQty"].ToString()),
				UnitQtyType        = (OpenDentBusiness.ProcUnitQtyType)PIn.Int(row["UnitQtyType"].ToString()),
				StatementNum       = PIn.Long  (row["StatementNum"].ToString()),
				IsLocked           = PIn.Bool  (row["IsLocked"].ToString()),
				BillingNote        = PIn.String(row["BillingNote"].ToString()),
				RepeatChargeNum    = PIn.Long  (row["RepeatChargeNum"].ToString()),
				DiagnosticCode2    = PIn.String(row["DiagnosticCode2"].ToString()),
				DiagnosticCode3    = PIn.String(row["DiagnosticCode3"].ToString()),
				DiagnosticCode4    = PIn.String(row["DiagnosticCode4"].ToString()),
				Discount           = PIn.Double(row["Discount"].ToString()),
				SnomedBodySite     = PIn.String(row["SnomedBodySite"].ToString()),
				ProvOrderOverride  = PIn.Long  (row["ProvOrderOverride"].ToString()),
				IsDateProsthEst    = PIn.Bool  (row["IsDateProsthEst"].ToString()),
				IcdVersion         = PIn.Byte  (row["IcdVersion"].ToString()),
				IsCpoe             = PIn.Bool  (row["IsCpoe"].ToString()),
				SecUserNumEntry    = PIn.Long  (row["SecUserNumEntry"].ToString()),
				SecDateEntry       = PIn.Date  (row["SecDateEntry"].ToString()),
				DateComplete       = PIn.Date  (row["DateComplete"].ToString()),
				OrderingReferralNum= PIn.Long  (row["OrderingReferralNum"].ToString()),
				TaxAmt             = PIn.Double(row["TaxAmt"].ToString()),
				Urgency            = (OpenDentBusiness.ProcUrgency)PIn.Int(row["Urgency"].ToString()),
				DiscountPlanAmt    = PIn.Double(row["DiscountPlanAmt"].ToString()),
			};
		}

		///<summary>Converts a list of Procedure into a DataTable.</summary>
		public static DataTable ListToTable(List<Procedure> listProcedures,string tableName="") {
			if(string.IsNullOrEmpty(tableName)) {
				tableName="Procedure";
			}
			DataTable table=new DataTable(tableName);
			table.Columns.Add("ProcNum");
			table.Columns.Add("PatNum");
			table.Columns.Add("AptNum");
			table.Columns.Add("OldCode");
			table.Columns.Add("ProcDate");
			table.Columns.Add("ProcFee");
			table.Columns.Add("Surf");
			table.Columns.Add("ToothNum");
			table.Columns.Add("ToothRange");
			table.Columns.Add("Priority");
			table.Columns.Add("ProcStatus");
			table.Columns.Add("ProvNum");
			table.Columns.Add("Dx");
			table.Columns.Add("PlannedAptNum");
			table.Columns.Add("PlaceService");
			table.Columns.Add("Prosthesis");
			table.Columns.Add("DateOriginalProsth");
			table.Columns.Add("ClaimNote");
			table.Columns.Add("DateEntryC");
			table.Columns.Add("ClinicNum");
			table.Columns.Add("MedicalCode");
			table.Columns.Add("DiagnosticCode");
			table.Columns.Add("IsPrincDiag");
			table.Columns.Add("ProcNumLab");
			table.Columns.Add("BillingTypeOne");
			table.Columns.Add("BillingTypeTwo");
			table.Columns.Add("CodeNum");
			table.Columns.Add("CodeMod1");
			table.Columns.Add("CodeMod2");
			table.Columns.Add("CodeMod3");
			table.Columns.Add("CodeMod4");
			table.Columns.Add("RevCode");
			table.Columns.Add("UnitQty");
			table.Columns.Add("BaseUnits");
			table.Columns.Add("StartTime");
			table.Columns.Add("StopTime");
			table.Columns.Add("DateTP");
			table.Columns.Add("SiteNum");
			table.Columns.Add("HideGraphics");
			table.Columns.Add("CanadianTypeCodes");
			table.Columns.Add("ProcTime");
			table.Columns.Add("ProcTimeEnd");
			table.Columns.Add("DateTStamp");
			table.Columns.Add("Prognosis");
			table.Columns.Add("DrugUnit");
			table.Columns.Add("DrugQty");
			table.Columns.Add("UnitQtyType");
			table.Columns.Add("StatementNum");
			table.Columns.Add("IsLocked");
			table.Columns.Add("BillingNote");
			table.Columns.Add("RepeatChargeNum");
			table.Columns.Add("DiagnosticCode2");
			table.Columns.Add("DiagnosticCode3");
			table.Columns.Add("DiagnosticCode4");
			table.Columns.Add("Discount");
			table.Columns.Add("SnomedBodySite");
			table.Columns.Add("ProvOrderOverride");
			table.Columns.Add("IsDateProsthEst");
			table.Columns.Add("IcdVersion");
			table.Columns.Add("IsCpoe");
			table.Columns.Add("SecUserNumEntry");
			table.Columns.Add("SecDateEntry");
			table.Columns.Add("DateComplete");
			table.Columns.Add("OrderingReferralNum");
			table.Columns.Add("TaxAmt");
			table.Columns.Add("Urgency");
			table.Columns.Add("DiscountPlanAmt");
			foreach(Procedure procedure in listProcedures) {
				table.Rows.Add(new object[] {
					POut.Long  (procedure.ProcNum),
					POut.Long  (procedure.PatNum),
					POut.Long  (procedure.AptNum),
					            procedure.OldCode,
					POut.DateT (procedure.ProcDate,false),
					POut.Double(procedure.ProcFee),
					            procedure.Surf,
					            procedure.ToothNum,
					            procedure.ToothRange,
					POut.Long  (procedure.Priority),
					POut.Int   ((int)procedure.ProcStatus),
					POut.Long  (procedure.ProvNum),
					POut.Long  (procedure.Dx),
					POut.Long  (procedure.PlannedAptNum),
					POut.Int   ((int)procedure.PlaceService),
					            procedure.Prosthesis,
					POut.DateT (procedure.DateOriginalProsth,false),
					            procedure.ClaimNote,
					POut.DateT (procedure.DateEntryC,false),
					POut.Long  (procedure.ClinicNum),
					            procedure.MedicalCode,
					            procedure.DiagnosticCode,
					POut.Bool  (procedure.IsPrincDiag),
					POut.Long  (procedure.ProcNumLab),
					POut.Long  (procedure.BillingTypeOne),
					POut.Long  (procedure.BillingTypeTwo),
					POut.Long  (procedure.CodeNum),
					            procedure.CodeMod1,
					            procedure.CodeMod2,
					            procedure.CodeMod3,
					            procedure.CodeMod4,
					            procedure.RevCode,
					POut.Int   (procedure.UnitQty),
					POut.Int   (procedure.BaseUnits),
					POut.Int   (procedure.StartTime),
					POut.Int   (procedure.StopTime),
					POut.DateT (procedure.DateTP,false),
					POut.Long  (procedure.SiteNum),
					POut.Bool  (procedure.HideGraphics),
					            procedure.CanadianTypeCodes,
					POut.Time  (procedure.ProcTime,false),
					POut.Time  (procedure.ProcTimeEnd,false),
					POut.DateT (procedure.DateTStamp,false),
					POut.Long  (procedure.Prognosis),
					POut.Int   ((int)procedure.DrugUnit),
					POut.Float (procedure.DrugQty),
					POut.Int   ((int)procedure.UnitQtyType),
					POut.Long  (procedure.StatementNum),
					POut.Bool  (procedure.IsLocked),
					            procedure.BillingNote,
					POut.Long  (procedure.RepeatChargeNum),
					            procedure.DiagnosticCode2,
					            procedure.DiagnosticCode3,
					            procedure.DiagnosticCode4,
					POut.Double(procedure.Discount),
					            procedure.SnomedBodySite,
					POut.Long  (procedure.ProvOrderOverride),
					POut.Bool  (procedure.IsDateProsthEst),
					POut.Byte  (procedure.IcdVersion),
					POut.Bool  (procedure.IsCpoe),
					POut.Long  (procedure.SecUserNumEntry),
					POut.DateT (procedure.SecDateEntry,false),
					POut.DateT (procedure.DateComplete,false),
					POut.Long  (procedure.OrderingReferralNum),
					POut.Double(procedure.TaxAmt),
					POut.Int   ((int)procedure.Urgency),
					POut.Double(procedure.DiscountPlanAmt),
				});
			}
			return table;
		}

		///<summary>Inserts one Procedure into the database.  Returns the new priKey.</summary>
		public static long Insert(Procedure procedure) {
			return Insert(procedure,false);
		}

		///<summary>Inserts one Procedure into the database.  Provides option to use the existing priKey.</summary>
		public static long Insert(Procedure procedure,bool useExistingPK) {
			if(!useExistingPK && PrefC.RandomKeys) {
				procedure.ProcNum=ReplicationServers.GetKey("procedurelog","ProcNum");
			}
			string command="INSERT INTO procedurelog (";
			if(useExistingPK || PrefC.RandomKeys) {
				command+="ProcNum,";
			}
			command+="PatNum,AptNum,OldCode,ProcDate,ProcFee,Surf,ToothNum,ToothRange,Priority,ProcStatus,ProvNum,Dx,PlannedAptNum,PlaceService,Prosthesis,DateOriginalProsth,ClaimNote,DateEntryC,ClinicNum,MedicalCode,DiagnosticCode,IsPrincDiag,ProcNumLab,BillingTypeOne,BillingTypeTwo,CodeNum,CodeMod1,CodeMod2,CodeMod3,CodeMod4,RevCode,UnitQty,BaseUnits,StartTime,StopTime,DateTP,SiteNum,HideGraphics,CanadianTypeCodes,ProcTime,ProcTimeEnd,Prognosis,DrugUnit,DrugQty,UnitQtyType,StatementNum,IsLocked,BillingNote,RepeatChargeNum,DiagnosticCode2,DiagnosticCode3,DiagnosticCode4,Discount,SnomedBodySite,ProvOrderOverride,IsDateProsthEst,IcdVersion,IsCpoe,SecUserNumEntry,SecDateEntry,DateComplete,OrderingReferralNum,TaxAmt,Urgency,DiscountPlanAmt) VALUES(";
			if(useExistingPK || PrefC.RandomKeys) {
				command+=POut.Long(procedure.ProcNum)+",";
			}
			command+=
				     POut.Long  (procedure.PatNum)+","
				+    POut.Long  (procedure.AptNum)+","
				+"'"+POut.String(procedure.OldCode)+"',"
				+    POut.Date  (procedure.ProcDate)+","
				+		 POut.Double(procedure.ProcFee)+","
				+"'"+POut.String(procedure.Surf)+"',"
				+"'"+POut.String(procedure.ToothNum)+"',"
				+"'"+POut.String(procedure.ToothRange)+"',"
				+    POut.Long  (procedure.Priority)+","
				+    POut.Int   ((int)procedure.ProcStatus)+","
				+    POut.Long  (procedure.ProvNum)+","
				+    POut.Long  (procedure.Dx)+","
				+    POut.Long  (procedure.PlannedAptNum)+","
				+    POut.Int   ((int)procedure.PlaceService)+","
				+"'"+POut.String(procedure.Prosthesis)+"',"
				+    POut.Date  (procedure.DateOriginalProsth)+","
				+"'"+POut.String(procedure.ClaimNote)+"',"
				+    DbHelper.Now()+","
				+    POut.Long  (procedure.ClinicNum)+","
				+"'"+POut.String(procedure.MedicalCode)+"',"
				+"'"+POut.String(procedure.DiagnosticCode)+"',"
				+    POut.Bool  (procedure.IsPrincDiag)+","
				+    POut.Long  (procedure.ProcNumLab)+","
				+    POut.Long  (procedure.BillingTypeOne)+","
				+    POut.Long  (procedure.BillingTypeTwo)+","
				+    POut.Long  (procedure.CodeNum)+","
				+"'"+POut.String(procedure.CodeMod1)+"',"
				+"'"+POut.String(procedure.CodeMod2)+"',"
				+"'"+POut.String(procedure.CodeMod3)+"',"
				+"'"+POut.String(procedure.CodeMod4)+"',"
				+"'"+POut.String(procedure.RevCode)+"',"
				+    POut.Int   (procedure.UnitQty)+","
				+    POut.Int   (procedure.BaseUnits)+","
				+    POut.Int   (procedure.StartTime)+","
				+    POut.Int   (procedure.StopTime)+","
				+    POut.Date  (procedure.DateTP)+","
				+    POut.Long  (procedure.SiteNum)+","
				+    POut.Bool  (procedure.HideGraphics)+","
				+"'"+POut.String(procedure.CanadianTypeCodes)+"',"
				+    POut.Time  (procedure.ProcTime)+","
				+    POut.Time  (procedure.ProcTimeEnd)+","
				//DateTStamp can only be set by MySQL
				+    POut.Long  (procedure.Prognosis)+","
				+    POut.Int   ((int)procedure.DrugUnit)+","
				+    POut.Float (procedure.DrugQty)+","
				+    POut.Int   ((int)procedure.UnitQtyType)+","
				+    POut.Long  (procedure.StatementNum)+","
				+    POut.Bool  (procedure.IsLocked)+","
				+"'"+POut.String(procedure.BillingNote)+"',"
				+    POut.Long  (procedure.RepeatChargeNum)+","
				+"'"+POut.String(procedure.DiagnosticCode2)+"',"
				+"'"+POut.String(procedure.DiagnosticCode3)+"',"
				+"'"+POut.String(procedure.DiagnosticCode4)+"',"
				+		 POut.Double(procedure.Discount)+","
				+"'"+POut.String(procedure.SnomedBodySite)+"',"
				+    POut.Long  (procedure.ProvOrderOverride)+","
				+    POut.Bool  (procedure.IsDateProsthEst)+","
				+    POut.Byte  (procedure.IcdVersion)+","
				+    POut.Bool  (procedure.IsCpoe)+","
				+    POut.Long  (procedure.SecUserNumEntry)+","
				+    DbHelper.Now()+","
				+    POut.Date  (procedure.DateComplete)+","
				+    POut.Long  (procedure.OrderingReferralNum)+","
				+		 POut.Double(procedure.TaxAmt)+","
				+    POut.Int   ((int)procedure.Urgency)+","
				+		 POut.Double(procedure.DiscountPlanAmt)+")";
			if(useExistingPK || PrefC.RandomKeys) {
				Db.NonQ(command);
			}
			else {
				procedure.ProcNum=Db.NonQ(command,true,"ProcNum","procedure");
			}
			return procedure.ProcNum;
		}

		///<summary>Inserts many Procedures into the database.</summary>
		public static void InsertMany(List<Procedure> listProcedures) {
			InsertMany(listProcedures,false);
		}

		///<summary>Inserts many Procedures into the database.  Provides option to use the existing priKey.</summary>
		public static void InsertMany(List<Procedure> listProcedures,bool useExistingPK) {
			if(!useExistingPK && PrefC.RandomKeys) {
				foreach(Procedure procedure in listProcedures) {
					Insert(procedure);
				}
			}
			else {
				StringBuilder sbCommands=null;
				int index=0;
				int countRows=0;
				while(index < listProcedures.Count) {
					Procedure procedure=listProcedures[index];
					StringBuilder sbRow=new StringBuilder("(");
					bool hasComma=false;
					if(sbCommands==null) {
						sbCommands=new StringBuilder();
						sbCommands.Append("INSERT INTO procedurelog (");
						if(useExistingPK) {
							sbCommands.Append("ProcNum,");
						}
						sbCommands.Append("PatNum,AptNum,OldCode,ProcDate,ProcFee,Surf,ToothNum,ToothRange,Priority,ProcStatus,ProvNum,Dx,PlannedAptNum,PlaceService,Prosthesis,DateOriginalProsth,ClaimNote,DateEntryC,ClinicNum,MedicalCode,DiagnosticCode,IsPrincDiag,ProcNumLab,BillingTypeOne,BillingTypeTwo,CodeNum,CodeMod1,CodeMod2,CodeMod3,CodeMod4,RevCode,UnitQty,BaseUnits,StartTime,StopTime,DateTP,SiteNum,HideGraphics,CanadianTypeCodes,ProcTime,ProcTimeEnd,Prognosis,DrugUnit,DrugQty,UnitQtyType,StatementNum,IsLocked,BillingNote,RepeatChargeNum,DiagnosticCode2,DiagnosticCode3,DiagnosticCode4,Discount,SnomedBodySite,ProvOrderOverride,IsDateProsthEst,IcdVersion,IsCpoe,SecUserNumEntry,SecDateEntry,DateComplete,OrderingReferralNum,TaxAmt,Urgency,DiscountPlanAmt) VALUES ");
						countRows=0;
					}
					else {
						hasComma=true;
					}
					if(useExistingPK) {
						sbRow.Append(POut.Long(procedure.ProcNum)); sbRow.Append(",");
					}
					sbRow.Append(POut.Long(procedure.PatNum)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.AptNum)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.OldCode)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Date(procedure.ProcDate)); sbRow.Append(",");
					sbRow.Append(POut.Double(procedure.ProcFee)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.Surf)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.ToothNum)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.ToothRange)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.Priority)); sbRow.Append(",");
					sbRow.Append(POut.Int((int)procedure.ProcStatus)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.ProvNum)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.Dx)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.PlannedAptNum)); sbRow.Append(",");
					sbRow.Append(POut.Int((int)procedure.PlaceService)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.Prosthesis)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Date(procedure.DateOriginalProsth)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.ClaimNote)+"'"); sbRow.Append(",");
					sbRow.Append(DbHelper.Now()); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.ClinicNum)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.MedicalCode)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.DiagnosticCode)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Bool(procedure.IsPrincDiag)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.ProcNumLab)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.BillingTypeOne)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.BillingTypeTwo)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.CodeNum)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.CodeMod1)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.CodeMod2)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.CodeMod3)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.CodeMod4)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.RevCode)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Int(procedure.UnitQty)); sbRow.Append(",");
					sbRow.Append(POut.Int(procedure.BaseUnits)); sbRow.Append(",");
					sbRow.Append(POut.Int(procedure.StartTime)); sbRow.Append(",");
					sbRow.Append(POut.Int(procedure.StopTime)); sbRow.Append(",");
					sbRow.Append(POut.Date(procedure.DateTP)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.SiteNum)); sbRow.Append(",");
					sbRow.Append(POut.Bool(procedure.HideGraphics)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.CanadianTypeCodes)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Time(procedure.ProcTime)); sbRow.Append(",");
					sbRow.Append(POut.Time(procedure.ProcTimeEnd)); sbRow.Append(",");
					//DateTStamp can only be set by MySQL
					sbRow.Append(POut.Long(procedure.Prognosis)); sbRow.Append(",");
					sbRow.Append(POut.Int((int)procedure.DrugUnit)); sbRow.Append(",");
					sbRow.Append(POut.Float(procedure.DrugQty)); sbRow.Append(",");
					sbRow.Append(POut.Int((int)procedure.UnitQtyType)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.StatementNum)); sbRow.Append(",");
					sbRow.Append(POut.Bool(procedure.IsLocked)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.BillingNote)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.RepeatChargeNum)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.DiagnosticCode2)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.DiagnosticCode3)+"'"); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.DiagnosticCode4)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Double(procedure.Discount)); sbRow.Append(",");
					sbRow.Append("'"+POut.String(procedure.SnomedBodySite)+"'"); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.ProvOrderOverride)); sbRow.Append(",");
					sbRow.Append(POut.Bool(procedure.IsDateProsthEst)); sbRow.Append(",");
					sbRow.Append(POut.Byte(procedure.IcdVersion)); sbRow.Append(",");
					sbRow.Append(POut.Bool(procedure.IsCpoe)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.SecUserNumEntry)); sbRow.Append(",");
					sbRow.Append(DbHelper.Now()); sbRow.Append(",");
					sbRow.Append(POut.Date(procedure.DateComplete)); sbRow.Append(",");
					sbRow.Append(POut.Long(procedure.OrderingReferralNum)); sbRow.Append(",");
					sbRow.Append(POut.Double(procedure.TaxAmt)); sbRow.Append(",");
					sbRow.Append(POut.Int((int)procedure.Urgency)); sbRow.Append(",");
					sbRow.Append(POut.Double(procedure.DiscountPlanAmt)); sbRow.Append(")");
					if(sbCommands.Length+sbRow.Length+1 > TableBase.MaxAllowedPacketCount && countRows > 0) {
						Db.NonQ(sbCommands.ToString());
						sbCommands=null;
					}
					else {
						if(hasComma) {
							sbCommands.Append(",");
						}
						sbCommands.Append(sbRow.ToString());
						countRows++;
						if(index==listProcedures.Count-1) {
							Db.NonQ(sbCommands.ToString());
						}
						index++;
					}
				}
			}
		}

		///<summary>Inserts one Procedure into the database.  Returns the new priKey.  Doesn't use the cache.</summary>
		public static long InsertNoCache(Procedure procedure) {
			return InsertNoCache(procedure,false);
		}

		///<summary>Inserts one Procedure into the database.  Provides option to use the existing priKey.  Doesn't use the cache.</summary>
		public static long InsertNoCache(Procedure procedure,bool useExistingPK) {
			bool isRandomKeys=Prefs.GetBoolNoCache(PrefName.RandomPrimaryKeys);
			string command="INSERT INTO procedurelog (";
			if(!useExistingPK && isRandomKeys) {
				procedure.ProcNum=ReplicationServers.GetKeyNoCache("procedurelog","ProcNum");
			}
			if(isRandomKeys || useExistingPK) {
				command+="ProcNum,";
			}
			command+="PatNum,AptNum,OldCode,ProcDate,ProcFee,Surf,ToothNum,ToothRange,Priority,ProcStatus,ProvNum,Dx,PlannedAptNum,PlaceService,Prosthesis,DateOriginalProsth,ClaimNote,DateEntryC,ClinicNum,MedicalCode,DiagnosticCode,IsPrincDiag,ProcNumLab,BillingTypeOne,BillingTypeTwo,CodeNum,CodeMod1,CodeMod2,CodeMod3,CodeMod4,RevCode,UnitQty,BaseUnits,StartTime,StopTime,DateTP,SiteNum,HideGraphics,CanadianTypeCodes,ProcTime,ProcTimeEnd,Prognosis,DrugUnit,DrugQty,UnitQtyType,StatementNum,IsLocked,BillingNote,RepeatChargeNum,DiagnosticCode2,DiagnosticCode3,DiagnosticCode4,Discount,SnomedBodySite,ProvOrderOverride,IsDateProsthEst,IcdVersion,IsCpoe,SecUserNumEntry,SecDateEntry,DateComplete,OrderingReferralNum,TaxAmt,Urgency,DiscountPlanAmt) VALUES(";
			if(isRandomKeys || useExistingPK) {
				command+=POut.Long(procedure.ProcNum)+",";
			}
			command+=
				     POut.Long  (procedure.PatNum)+","
				+    POut.Long  (procedure.AptNum)+","
				+"'"+POut.String(procedure.OldCode)+"',"
				+    POut.Date  (procedure.ProcDate)+","
				+	   POut.Double(procedure.ProcFee)+","
				+"'"+POut.String(procedure.Surf)+"',"
				+"'"+POut.String(procedure.ToothNum)+"',"
				+"'"+POut.String(procedure.ToothRange)+"',"
				+    POut.Long  (procedure.Priority)+","
				+    POut.Int   ((int)procedure.ProcStatus)+","
				+    POut.Long  (procedure.ProvNum)+","
				+    POut.Long  (procedure.Dx)+","
				+    POut.Long  (procedure.PlannedAptNum)+","
				+    POut.Int   ((int)procedure.PlaceService)+","
				+"'"+POut.String(procedure.Prosthesis)+"',"
				+    POut.Date  (procedure.DateOriginalProsth)+","
				+"'"+POut.String(procedure.ClaimNote)+"',"
				+    DbHelper.Now()+","
				+    POut.Long  (procedure.ClinicNum)+","
				+"'"+POut.String(procedure.MedicalCode)+"',"
				+"'"+POut.String(procedure.DiagnosticCode)+"',"
				+    POut.Bool  (procedure.IsPrincDiag)+","
				+    POut.Long  (procedure.ProcNumLab)+","
				+    POut.Long  (procedure.BillingTypeOne)+","
				+    POut.Long  (procedure.BillingTypeTwo)+","
				+    POut.Long  (procedure.CodeNum)+","
				+"'"+POut.String(procedure.CodeMod1)+"',"
				+"'"+POut.String(procedure.CodeMod2)+"',"
				+"'"+POut.String(procedure.CodeMod3)+"',"
				+"'"+POut.String(procedure.CodeMod4)+"',"
				+"'"+POut.String(procedure.RevCode)+"',"
				+    POut.Int   (procedure.UnitQty)+","
				+    POut.Int   (procedure.BaseUnits)+","
				+    POut.Int   (procedure.StartTime)+","
				+    POut.Int   (procedure.StopTime)+","
				+    POut.Date  (procedure.DateTP)+","
				+    POut.Long  (procedure.SiteNum)+","
				+    POut.Bool  (procedure.HideGraphics)+","
				+"'"+POut.String(procedure.CanadianTypeCodes)+"',"
				+    POut.Time  (procedure.ProcTime)+","
				+    POut.Time  (procedure.ProcTimeEnd)+","
				//DateTStamp can only be set by MySQL
				+    POut.Long  (procedure.Prognosis)+","
				+    POut.Int   ((int)procedure.DrugUnit)+","
				+    POut.Float (procedure.DrugQty)+","
				+    POut.Int   ((int)procedure.UnitQtyType)+","
				+    POut.Long  (procedure.StatementNum)+","
				+    POut.Bool  (procedure.IsLocked)+","
				+"'"+POut.String(procedure.BillingNote)+"',"
				+    POut.Long  (procedure.RepeatChargeNum)+","
				+"'"+POut.String(procedure.DiagnosticCode2)+"',"
				+"'"+POut.String(procedure.DiagnosticCode3)+"',"
				+"'"+POut.String(procedure.DiagnosticCode4)+"',"
				+	   POut.Double(procedure.Discount)+","
				+"'"+POut.String(procedure.SnomedBodySite)+"',"
				+    POut.Long  (procedure.ProvOrderOverride)+","
				+    POut.Bool  (procedure.IsDateProsthEst)+","
				+    POut.Byte  (procedure.IcdVersion)+","
				+    POut.Bool  (procedure.IsCpoe)+","
				+    POut.Long  (procedure.SecUserNumEntry)+","
				+    DbHelper.Now()+","
				+    POut.Date  (procedure.DateComplete)+","
				+    POut.Long  (procedure.OrderingReferralNum)+","
				+	   POut.Double(procedure.TaxAmt)+","
				+    POut.Int   ((int)procedure.Urgency)+","
				+	   POut.Double(procedure.DiscountPlanAmt)+")";
			if(useExistingPK || isRandomKeys) {
				Db.NonQ(command);
			}
			else {
				procedure.ProcNum=Db.NonQ(command,true,"ProcNum","procedure");
			}
			return procedure.ProcNum;
		}

		///<summary>Updates one Procedure in the database.</summary>
		public static void Update(Procedure procedure) {
			string command="UPDATE procedurelog SET "
				+"PatNum             =  "+POut.Long  (procedure.PatNum)+", "
				+"AptNum             =  "+POut.Long  (procedure.AptNum)+", "
				+"OldCode            = '"+POut.String(procedure.OldCode)+"', "
				+"ProcDate           =  "+POut.Date  (procedure.ProcDate)+", "
				+"ProcFee            =  "+POut.Double(procedure.ProcFee)+", "
				+"Surf               = '"+POut.String(procedure.Surf)+"', "
				+"ToothNum           = '"+POut.String(procedure.ToothNum)+"', "
				+"ToothRange         = '"+POut.String(procedure.ToothRange)+"', "
				+"Priority           =  "+POut.Long  (procedure.Priority)+", "
				+"ProcStatus         =  "+POut.Int   ((int)procedure.ProcStatus)+", "
				+"ProvNum            =  "+POut.Long  (procedure.ProvNum)+", "
				+"Dx                 =  "+POut.Long  (procedure.Dx)+", "
				+"PlannedAptNum      =  "+POut.Long  (procedure.PlannedAptNum)+", "
				+"PlaceService       =  "+POut.Int   ((int)procedure.PlaceService)+", "
				+"Prosthesis         = '"+POut.String(procedure.Prosthesis)+"', "
				+"DateOriginalProsth =  "+POut.Date  (procedure.DateOriginalProsth)+", "
				+"ClaimNote          = '"+POut.String(procedure.ClaimNote)+"', "
				+"DateEntryC         =  "+POut.Date  (procedure.DateEntryC)+", "
				+"ClinicNum          =  "+POut.Long  (procedure.ClinicNum)+", "
				+"MedicalCode        = '"+POut.String(procedure.MedicalCode)+"', "
				+"DiagnosticCode     = '"+POut.String(procedure.DiagnosticCode)+"', "
				+"IsPrincDiag        =  "+POut.Bool  (procedure.IsPrincDiag)+", "
				+"ProcNumLab         =  "+POut.Long  (procedure.ProcNumLab)+", "
				+"BillingTypeOne     =  "+POut.Long  (procedure.BillingTypeOne)+", "
				+"BillingTypeTwo     =  "+POut.Long  (procedure.BillingTypeTwo)+", "
				+"CodeNum            =  "+POut.Long  (procedure.CodeNum)+", "
				+"CodeMod1           = '"+POut.String(procedure.CodeMod1)+"', "
				+"CodeMod2           = '"+POut.String(procedure.CodeMod2)+"', "
				+"CodeMod3           = '"+POut.String(procedure.CodeMod3)+"', "
				+"CodeMod4           = '"+POut.String(procedure.CodeMod4)+"', "
				+"RevCode            = '"+POut.String(procedure.RevCode)+"', "
				+"UnitQty            =  "+POut.Int   (procedure.UnitQty)+", "
				+"BaseUnits          =  "+POut.Int   (procedure.BaseUnits)+", "
				+"StartTime          =  "+POut.Int   (procedure.StartTime)+", "
				+"StopTime           =  "+POut.Int   (procedure.StopTime)+", "
				+"DateTP             =  "+POut.Date  (procedure.DateTP)+", "
				+"SiteNum            =  "+POut.Long  (procedure.SiteNum)+", "
				+"HideGraphics       =  "+POut.Bool  (procedure.HideGraphics)+", "
				+"CanadianTypeCodes  = '"+POut.String(procedure.CanadianTypeCodes)+"', "
				+"ProcTime           =  "+POut.Time  (procedure.ProcTime)+", "
				+"ProcTimeEnd        =  "+POut.Time  (procedure.ProcTimeEnd)+", "
				//DateTStamp can only be set by MySQL
				+"Prognosis          =  "+POut.Long  (procedure.Prognosis)+", "
				+"DrugUnit           =  "+POut.Int   ((int)procedure.DrugUnit)+", "
				+"DrugQty            =  "+POut.Float (procedure.DrugQty)+", "
				+"UnitQtyType        =  "+POut.Int   ((int)procedure.UnitQtyType)+", "
				+"StatementNum       =  "+POut.Long  (procedure.StatementNum)+", "
				+"IsLocked           =  "+POut.Bool  (procedure.IsLocked)+", "
				+"BillingNote        = '"+POut.String(procedure.BillingNote)+"', "
				+"RepeatChargeNum    =  "+POut.Long  (procedure.RepeatChargeNum)+", "
				+"DiagnosticCode2    = '"+POut.String(procedure.DiagnosticCode2)+"', "
				+"DiagnosticCode3    = '"+POut.String(procedure.DiagnosticCode3)+"', "
				+"DiagnosticCode4    = '"+POut.String(procedure.DiagnosticCode4)+"', "
				+"Discount           =  "+POut.Double(procedure.Discount)+", "
				+"SnomedBodySite     = '"+POut.String(procedure.SnomedBodySite)+"', "
				+"ProvOrderOverride  =  "+POut.Long  (procedure.ProvOrderOverride)+", "
				+"IsDateProsthEst    =  "+POut.Bool  (procedure.IsDateProsthEst)+", "
				+"IcdVersion         =  "+POut.Byte  (procedure.IcdVersion)+", "
				+"IsCpoe             =  "+POut.Bool  (procedure.IsCpoe)+", "
				//SecUserNumEntry excluded from update
				//SecDateEntry not allowed to change
				+"DateComplete       =  "+POut.Date  (procedure.DateComplete)+", "
				+"OrderingReferralNum=  "+POut.Long  (procedure.OrderingReferralNum)+", "
				+"TaxAmt             =  "+POut.Double(procedure.TaxAmt)+", "
				+"Urgency            =  "+POut.Int   ((int)procedure.Urgency)+", "
				+"DiscountPlanAmt    =  "+POut.Double(procedure.DiscountPlanAmt)+" "
				+"WHERE ProcNum = "+POut.Long(procedure.ProcNum);
			Db.NonQ(command);
		}

		///<summary>Updates one Procedure in the database.  Uses an old object to compare to, and only alters changed fields.  This prevents collisions and concurrency problems in heavily used tables.  Returns true if an update occurred.</summary>
		public static bool Update(Procedure procedure,Procedure oldProcedure) {
			string command="";
			if(procedure.PatNum != oldProcedure.PatNum) {
				if(command!="") { command+=",";}
				command+="PatNum = "+POut.Long(procedure.PatNum)+"";
			}
			if(procedure.AptNum != oldProcedure.AptNum) {
				if(command!="") { command+=",";}
				command+="AptNum = "+POut.Long(procedure.AptNum)+"";
			}
			if(procedure.OldCode != oldProcedure.OldCode) {
				if(command!="") { command+=",";}
				command+="OldCode = '"+POut.String(procedure.OldCode)+"'";
			}
			if(procedure.ProcDate.Date != oldProcedure.ProcDate.Date) {
				if(command!="") { command+=",";}
				command+="ProcDate = "+POut.Date(procedure.ProcDate)+"";
			}
			if(procedure.ProcFee != oldProcedure.ProcFee) {
				if(command!="") { command+=",";}
				command+="ProcFee = "+POut.Double(procedure.ProcFee)+"";
			}
			if(procedure.Surf != oldProcedure.Surf) {
				if(command!="") { command+=",";}
				command+="Surf = '"+POut.String(procedure.Surf)+"'";
			}
			if(procedure.ToothNum != oldProcedure.ToothNum) {
				if(command!="") { command+=",";}
				command+="ToothNum = '"+POut.String(procedure.ToothNum)+"'";
			}
			if(procedure.ToothRange != oldProcedure.ToothRange) {
				if(command!="") { command+=",";}
				command+="ToothRange = '"+POut.String(procedure.ToothRange)+"'";
			}
			if(procedure.Priority != oldProcedure.Priority) {
				if(command!="") { command+=",";}
				command+="Priority = "+POut.Long(procedure.Priority)+"";
			}
			if(procedure.ProcStatus != oldProcedure.ProcStatus) {
				if(command!="") { command+=",";}
				command+="ProcStatus = "+POut.Int   ((int)procedure.ProcStatus)+"";
			}
			if(procedure.ProvNum != oldProcedure.ProvNum) {
				if(command!="") { command+=",";}
				command+="ProvNum = "+POut.Long(procedure.ProvNum)+"";
			}
			if(procedure.Dx != oldProcedure.Dx) {
				if(command!="") { command+=",";}
				command+="Dx = "+POut.Long(procedure.Dx)+"";
			}
			if(procedure.PlannedAptNum != oldProcedure.PlannedAptNum) {
				if(command!="") { command+=",";}
				command+="PlannedAptNum = "+POut.Long(procedure.PlannedAptNum)+"";
			}
			if(procedure.PlaceService != oldProcedure.PlaceService) {
				if(command!="") { command+=",";}
				command+="PlaceService = "+POut.Int   ((int)procedure.PlaceService)+"";
			}
			if(procedure.Prosthesis != oldProcedure.Prosthesis) {
				if(command!="") { command+=",";}
				command+="Prosthesis = '"+POut.String(procedure.Prosthesis)+"'";
			}
			if(procedure.DateOriginalProsth.Date != oldProcedure.DateOriginalProsth.Date) {
				if(command!="") { command+=",";}
				command+="DateOriginalProsth = "+POut.Date(procedure.DateOriginalProsth)+"";
			}
			if(procedure.ClaimNote != oldProcedure.ClaimNote) {
				if(command!="") { command+=",";}
				command+="ClaimNote = '"+POut.String(procedure.ClaimNote)+"'";
			}
			if(procedure.DateEntryC.Date != oldProcedure.DateEntryC.Date) {
				if(command!="") { command+=",";}
				command+="DateEntryC = "+POut.Date(procedure.DateEntryC)+"";
			}
			if(procedure.ClinicNum != oldProcedure.ClinicNum) {
				if(command!="") { command+=",";}
				command+="ClinicNum = "+POut.Long(procedure.ClinicNum)+"";
			}
			if(procedure.MedicalCode != oldProcedure.MedicalCode) {
				if(command!="") { command+=",";}
				command+="MedicalCode = '"+POut.String(procedure.MedicalCode)+"'";
			}
			if(procedure.DiagnosticCode != oldProcedure.DiagnosticCode) {
				if(command!="") { command+=",";}
				command+="DiagnosticCode = '"+POut.String(procedure.DiagnosticCode)+"'";
			}
			if(procedure.IsPrincDiag != oldProcedure.IsPrincDiag) {
				if(command!="") { command+=",";}
				command+="IsPrincDiag = "+POut.Bool(procedure.IsPrincDiag)+"";
			}
			if(procedure.ProcNumLab != oldProcedure.ProcNumLab) {
				if(command!="") { command+=",";}
				command+="ProcNumLab = "+POut.Long(procedure.ProcNumLab)+"";
			}
			if(procedure.BillingTypeOne != oldProcedure.BillingTypeOne) {
				if(command!="") { command+=",";}
				command+="BillingTypeOne = "+POut.Long(procedure.BillingTypeOne)+"";
			}
			if(procedure.BillingTypeTwo != oldProcedure.BillingTypeTwo) {
				if(command!="") { command+=",";}
				command+="BillingTypeTwo = "+POut.Long(procedure.BillingTypeTwo)+"";
			}
			if(procedure.CodeNum != oldProcedure.CodeNum) {
				if(command!="") { command+=",";}
				command+="CodeNum = "+POut.Long(procedure.CodeNum)+"";
			}
			if(procedure.CodeMod1 != oldProcedure.CodeMod1) {
				if(command!="") { command+=",";}
				command+="CodeMod1 = '"+POut.String(procedure.CodeMod1)+"'";
			}
			if(procedure.CodeMod2 != oldProcedure.CodeMod2) {
				if(command!="") { command+=",";}
				command+="CodeMod2 = '"+POut.String(procedure.CodeMod2)+"'";
			}
			if(procedure.CodeMod3 != oldProcedure.CodeMod3) {
				if(command!="") { command+=",";}
				command+="CodeMod3 = '"+POut.String(procedure.CodeMod3)+"'";
			}
			if(procedure.CodeMod4 != oldProcedure.CodeMod4) {
				if(command!="") { command+=",";}
				command+="CodeMod4 = '"+POut.String(procedure.CodeMod4)+"'";
			}
			if(procedure.RevCode != oldProcedure.RevCode) {
				if(command!="") { command+=",";}
				command+="RevCode = '"+POut.String(procedure.RevCode)+"'";
			}
			if(procedure.UnitQty != oldProcedure.UnitQty) {
				if(command!="") { command+=",";}
				command+="UnitQty = "+POut.Int(procedure.UnitQty)+"";
			}
			if(procedure.BaseUnits != oldProcedure.BaseUnits) {
				if(command!="") { command+=",";}
				command+="BaseUnits = "+POut.Int(procedure.BaseUnits)+"";
			}
			if(procedure.StartTime != oldProcedure.StartTime) {
				if(command!="") { command+=",";}
				command+="StartTime = "+POut.Int(procedure.StartTime)+"";
			}
			if(procedure.StopTime != oldProcedure.StopTime) {
				if(command!="") { command+=",";}
				command+="StopTime = "+POut.Int(procedure.StopTime)+"";
			}
			if(procedure.DateTP.Date != oldProcedure.DateTP.Date) {
				if(command!="") { command+=",";}
				command+="DateTP = "+POut.Date(procedure.DateTP)+"";
			}
			if(procedure.SiteNum != oldProcedure.SiteNum) {
				if(command!="") { command+=",";}
				command+="SiteNum = "+POut.Long(procedure.SiteNum)+"";
			}
			if(procedure.HideGraphics != oldProcedure.HideGraphics) {
				if(command!="") { command+=",";}
				command+="HideGraphics = "+POut.Bool(procedure.HideGraphics)+"";
			}
			if(procedure.CanadianTypeCodes != oldProcedure.CanadianTypeCodes) {
				if(command!="") { command+=",";}
				command+="CanadianTypeCodes = '"+POut.String(procedure.CanadianTypeCodes)+"'";
			}
			if(procedure.ProcTime != oldProcedure.ProcTime) {
				if(command!="") { command+=",";}
				command+="ProcTime = "+POut.Time  (procedure.ProcTime)+"";
			}
			if(procedure.ProcTimeEnd != oldProcedure.ProcTimeEnd) {
				if(command!="") { command+=",";}
				command+="ProcTimeEnd = "+POut.Time  (procedure.ProcTimeEnd)+"";
			}
			//DateTStamp can only be set by MySQL
			if(procedure.Prognosis != oldProcedure.Prognosis) {
				if(command!="") { command+=",";}
				command+="Prognosis = "+POut.Long(procedure.Prognosis)+"";
			}
			if(procedure.DrugUnit != oldProcedure.DrugUnit) {
				if(command!="") { command+=",";}
				command+="DrugUnit = "+POut.Int   ((int)procedure.DrugUnit)+"";
			}
			if(procedure.DrugQty != oldProcedure.DrugQty) {
				if(command!="") { command+=",";}
				command+="DrugQty = "+POut.Float(procedure.DrugQty)+"";
			}
			if(procedure.UnitQtyType != oldProcedure.UnitQtyType) {
				if(command!="") { command+=",";}
				command+="UnitQtyType = "+POut.Int   ((int)procedure.UnitQtyType)+"";
			}
			if(procedure.StatementNum != oldProcedure.StatementNum) {
				if(command!="") { command+=",";}
				command+="StatementNum = "+POut.Long(procedure.StatementNum)+"";
			}
			if(procedure.IsLocked != oldProcedure.IsLocked) {
				if(command!="") { command+=",";}
				command+="IsLocked = "+POut.Bool(procedure.IsLocked)+"";
			}
			if(procedure.BillingNote != oldProcedure.BillingNote) {
				if(command!="") { command+=",";}
				command+="BillingNote = '"+POut.String(procedure.BillingNote)+"'";
			}
			if(procedure.RepeatChargeNum != oldProcedure.RepeatChargeNum) {
				if(command!="") { command+=",";}
				command+="RepeatChargeNum = "+POut.Long(procedure.RepeatChargeNum)+"";
			}
			if(procedure.DiagnosticCode2 != oldProcedure.DiagnosticCode2) {
				if(command!="") { command+=",";}
				command+="DiagnosticCode2 = '"+POut.String(procedure.DiagnosticCode2)+"'";
			}
			if(procedure.DiagnosticCode3 != oldProcedure.DiagnosticCode3) {
				if(command!="") { command+=",";}
				command+="DiagnosticCode3 = '"+POut.String(procedure.DiagnosticCode3)+"'";
			}
			if(procedure.DiagnosticCode4 != oldProcedure.DiagnosticCode4) {
				if(command!="") { command+=",";}
				command+="DiagnosticCode4 = '"+POut.String(procedure.DiagnosticCode4)+"'";
			}
			if(procedure.Discount != oldProcedure.Discount) {
				if(command!="") { command+=",";}
				command+="Discount = "+POut.Double(procedure.Discount)+"";
			}
			if(procedure.SnomedBodySite != oldProcedure.SnomedBodySite) {
				if(command!="") { command+=",";}
				command+="SnomedBodySite = '"+POut.String(procedure.SnomedBodySite)+"'";
			}
			if(procedure.ProvOrderOverride != oldProcedure.ProvOrderOverride) {
				if(command!="") { command+=",";}
				command+="ProvOrderOverride = "+POut.Long(procedure.ProvOrderOverride)+"";
			}
			if(procedure.IsDateProsthEst != oldProcedure.IsDateProsthEst) {
				if(command!="") { command+=",";}
				command+="IsDateProsthEst = "+POut.Bool(procedure.IsDateProsthEst)+"";
			}
			if(procedure.IcdVersion != oldProcedure.IcdVersion) {
				if(command!="") { command+=",";}
				command+="IcdVersion = "+POut.Byte(procedure.IcdVersion)+"";
			}
			if(procedure.IsCpoe != oldProcedure.IsCpoe) {
				if(command!="") { command+=",";}
				command+="IsCpoe = "+POut.Bool(procedure.IsCpoe)+"";
			}
			//SecUserNumEntry excluded from update
			//SecDateEntry not allowed to change
			if(procedure.DateComplete.Date != oldProcedure.DateComplete.Date) {
				if(command!="") { command+=",";}
				command+="DateComplete = "+POut.Date(procedure.DateComplete)+"";
			}
			if(procedure.OrderingReferralNum != oldProcedure.OrderingReferralNum) {
				if(command!="") { command+=",";}
				command+="OrderingReferralNum = "+POut.Long(procedure.OrderingReferralNum)+"";
			}
			if(procedure.TaxAmt != oldProcedure.TaxAmt) {
				if(command!="") { command+=",";}
				command+="TaxAmt = "+POut.Double(procedure.TaxAmt)+"";
			}
			if(procedure.Urgency != oldProcedure.Urgency) {
				if(command!="") { command+=",";}
				command+="Urgency = "+POut.Int   ((int)procedure.Urgency)+"";
			}
			if(procedure.DiscountPlanAmt != oldProcedure.DiscountPlanAmt) {
				if(command!="") { command+=",";}
				command+="DiscountPlanAmt = "+POut.Double(procedure.DiscountPlanAmt)+"";
			}
			if(command=="") {
				return false;
			}
			command="UPDATE procedurelog SET "+command
				+" WHERE ProcNum = "+POut.Long(procedure.ProcNum);
			Db.NonQ(command);
			return true;
		}

		///<summary>Returns true if Update(Procedure,Procedure) would make changes to the database.
		///Does not make any changes to the database and can be called before remoting role is checked.</summary>
		public static bool UpdateComparison(Procedure procedure,Procedure oldProcedure) {
			if(procedure.PatNum != oldProcedure.PatNum) {
				return true;
			}
			if(procedure.AptNum != oldProcedure.AptNum) {
				return true;
			}
			if(procedure.OldCode != oldProcedure.OldCode) {
				return true;
			}
			if(procedure.ProcDate.Date != oldProcedure.ProcDate.Date) {
				return true;
			}
			if(procedure.ProcFee != oldProcedure.ProcFee) {
				return true;
			}
			if(procedure.Surf != oldProcedure.Surf) {
				return true;
			}
			if(procedure.ToothNum != oldProcedure.ToothNum) {
				return true;
			}
			if(procedure.ToothRange != oldProcedure.ToothRange) {
				return true;
			}
			if(procedure.Priority != oldProcedure.Priority) {
				return true;
			}
			if(procedure.ProcStatus != oldProcedure.ProcStatus) {
				return true;
			}
			if(procedure.ProvNum != oldProcedure.ProvNum) {
				return true;
			}
			if(procedure.Dx != oldProcedure.Dx) {
				return true;
			}
			if(procedure.PlannedAptNum != oldProcedure.PlannedAptNum) {
				return true;
			}
			if(procedure.PlaceService != oldProcedure.PlaceService) {
				return true;
			}
			if(procedure.Prosthesis != oldProcedure.Prosthesis) {
				return true;
			}
			if(procedure.DateOriginalProsth.Date != oldProcedure.DateOriginalProsth.Date) {
				return true;
			}
			if(procedure.ClaimNote != oldProcedure.ClaimNote) {
				return true;
			}
			if(procedure.DateEntryC.Date != oldProcedure.DateEntryC.Date) {
				return true;
			}
			if(procedure.ClinicNum != oldProcedure.ClinicNum) {
				return true;
			}
			if(procedure.MedicalCode != oldProcedure.MedicalCode) {
				return true;
			}
			if(procedure.DiagnosticCode != oldProcedure.DiagnosticCode) {
				return true;
			}
			if(procedure.IsPrincDiag != oldProcedure.IsPrincDiag) {
				return true;
			}
			if(procedure.ProcNumLab != oldProcedure.ProcNumLab) {
				return true;
			}
			if(procedure.BillingTypeOne != oldProcedure.BillingTypeOne) {
				return true;
			}
			if(procedure.BillingTypeTwo != oldProcedure.BillingTypeTwo) {
				return true;
			}
			if(procedure.CodeNum != oldProcedure.CodeNum) {
				return true;
			}
			if(procedure.CodeMod1 != oldProcedure.CodeMod1) {
				return true;
			}
			if(procedure.CodeMod2 != oldProcedure.CodeMod2) {
				return true;
			}
			if(procedure.CodeMod3 != oldProcedure.CodeMod3) {
				return true;
			}
			if(procedure.CodeMod4 != oldProcedure.CodeMod4) {
				return true;
			}
			if(procedure.RevCode != oldProcedure.RevCode) {
				return true;
			}
			if(procedure.UnitQty != oldProcedure.UnitQty) {
				return true;
			}
			if(procedure.BaseUnits != oldProcedure.BaseUnits) {
				return true;
			}
			if(procedure.StartTime != oldProcedure.StartTime) {
				return true;
			}
			if(procedure.StopTime != oldProcedure.StopTime) {
				return true;
			}
			if(procedure.DateTP.Date != oldProcedure.DateTP.Date) {
				return true;
			}
			if(procedure.SiteNum != oldProcedure.SiteNum) {
				return true;
			}
			if(procedure.HideGraphics != oldProcedure.HideGraphics) {
				return true;
			}
			if(procedure.CanadianTypeCodes != oldProcedure.CanadianTypeCodes) {
				return true;
			}
			if(procedure.ProcTime != oldProcedure.ProcTime) {
				return true;
			}
			if(procedure.ProcTimeEnd != oldProcedure.ProcTimeEnd) {
				return true;
			}
			//DateTStamp can only be set by MySQL
			if(procedure.Prognosis != oldProcedure.Prognosis) {
				return true;
			}
			if(procedure.DrugUnit != oldProcedure.DrugUnit) {
				return true;
			}
			if(procedure.DrugQty != oldProcedure.DrugQty) {
				return true;
			}
			if(procedure.UnitQtyType != oldProcedure.UnitQtyType) {
				return true;
			}
			if(procedure.StatementNum != oldProcedure.StatementNum) {
				return true;
			}
			if(procedure.IsLocked != oldProcedure.IsLocked) {
				return true;
			}
			if(procedure.BillingNote != oldProcedure.BillingNote) {
				return true;
			}
			if(procedure.RepeatChargeNum != oldProcedure.RepeatChargeNum) {
				return true;
			}
			if(procedure.DiagnosticCode2 != oldProcedure.DiagnosticCode2) {
				return true;
			}
			if(procedure.DiagnosticCode3 != oldProcedure.DiagnosticCode3) {
				return true;
			}
			if(procedure.DiagnosticCode4 != oldProcedure.DiagnosticCode4) {
				return true;
			}
			if(procedure.Discount != oldProcedure.Discount) {
				return true;
			}
			if(procedure.SnomedBodySite != oldProcedure.SnomedBodySite) {
				return true;
			}
			if(procedure.ProvOrderOverride != oldProcedure.ProvOrderOverride) {
				return true;
			}
			if(procedure.IsDateProsthEst != oldProcedure.IsDateProsthEst) {
				return true;
			}
			if(procedure.IcdVersion != oldProcedure.IcdVersion) {
				return true;
			}
			if(procedure.IsCpoe != oldProcedure.IsCpoe) {
				return true;
			}
			//SecUserNumEntry excluded from update
			//SecDateEntry not allowed to change
			if(procedure.DateComplete.Date != oldProcedure.DateComplete.Date) {
				return true;
			}
			if(procedure.OrderingReferralNum != oldProcedure.OrderingReferralNum) {
				return true;
			}
			if(procedure.TaxAmt != oldProcedure.TaxAmt) {
				return true;
			}
			if(procedure.Urgency != oldProcedure.Urgency) {
				return true;
			}
			if(procedure.DiscountPlanAmt != oldProcedure.DiscountPlanAmt) {
				return true;
			}
			return false;
		}

		//Delete not allowed for this table
		//public static void Delete(long procNum) {
		//
		//}

		//Delete not allowed for this table
		//public static void DeleteMany(List<long> listProcNums) {
		//
		//}

		///<summary>Inserts, updates, or deletes database rows to match supplied list.  Returns true if db changes were made.
		///Supply Security.CurUser.UserNum, used to set the SecUserNumEntry field for Inserts.</summary>
		public static bool Sync(List<Procedure> listNew,List<Procedure> listDB,long userNum) {
			//Adding items to lists changes the order of operation. All inserts are completed first, then updates, then deletes.
			List<Procedure> listIns    =new List<Procedure>();
			List<Procedure> listUpdNew =new List<Procedure>();
			List<Procedure> listUpdDB  =new List<Procedure>();
			List<Procedure> listDel    =new List<Procedure>();
			listNew.Sort((Procedure x,Procedure y) => { return x.ProcNum.CompareTo(y.ProcNum); });//Anonymous function, sorts by compairing PK.  Lambda expressions are not allowed, this is the one and only exception.  JS approved.
			listDB.Sort((Procedure x,Procedure y) => { return x.ProcNum.CompareTo(y.ProcNum); });//Anonymous function, sorts by compairing PK.  Lambda expressions are not allowed, this is the one and only exception.  JS approved.
			int idxNew=0;
			int idxDB=0;
			int rowsUpdatedCount=0;
			Procedure fieldNew;
			Procedure fieldDB;
			//Because both lists have been sorted using the same criteria, we can now walk each list to determine which list contians the next element.  The next element is determined by Primary Key.
			//If the New list contains the next item it will be inserted.  If the DB contains the next item, it will be deleted.  If both lists contain the next item, the item will be updated.
			while(idxNew<listNew.Count || idxDB<listDB.Count) {
				fieldNew=null;
				if(idxNew<listNew.Count) {
					fieldNew=listNew[idxNew];
				}
				fieldDB=null;
				if(idxDB<listDB.Count) {
					fieldDB=listDB[idxDB];
				}
				//begin compare
				if(fieldNew!=null && fieldDB==null) {//listNew has more items, listDB does not.
					listIns.Add(fieldNew);
					idxNew++;
					continue;
				}
				else if(fieldNew==null && fieldDB!=null) {//listDB has more items, listNew does not.
					listDel.Add(fieldDB);
					idxDB++;
					continue;
				}
				else if(fieldNew.ProcNum<fieldDB.ProcNum) {//newPK less than dbPK, newItem is 'next'
					listIns.Add(fieldNew);
					idxNew++;
					continue;
				}
				else if(fieldNew.ProcNum>fieldDB.ProcNum) {//dbPK less than newPK, dbItem is 'next'
					listDel.Add(fieldDB);
					idxDB++;
					continue;
				}
				//Both lists contain the 'next' item, update required
				listUpdNew.Add(fieldNew);
				listUpdDB.Add(fieldDB);
				idxNew++;
				idxDB++;
			}
			//Commit changes to DB
			for(int i=0;i<listIns.Count;i++) {
				listIns[i].SecUserNumEntry=userNum;
				Insert(listIns[i]);
			}
			for(int i=0;i<listUpdNew.Count;i++) {
				if(Update(listUpdNew[i],listUpdDB[i])) {
					rowsUpdatedCount++;
				}
			}
			for(int i=0;i<listDel.Count;i++) {
				Procedures.Delete(listDel[i].ProcNum);
			}
			if(rowsUpdatedCount>0 || listIns.Count>0 || listDel.Count>0) {
				return true;
			}
			return false;
		}

	}
}